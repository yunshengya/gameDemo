<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>âœ¨ ç¥ç¦å¼¹çª— âœ¨</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'PingFang SC', 'Helvetica Neue', Arial, sans-serif;
      background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      overflow: hidden;
      color: white;
      padding: 20px;
      position: relative;
    }

    .background {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: url('https://images.unsplash.com/photo-1533134486753-c833f0ed4866?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2070&q=80') no-repeat center center;
      background-size: cover;
      z-index: -2;
    }

    .background-overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.3);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      z-index: -1;
    }

    .popup-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 100;
    }

    .popup {
      position: absolute;
      background: rgba(255, 255, 255, 0.25);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border-radius: 16px;
      padding: 15px 20px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
      color: white;
      font-weight: 500;
      transition: transform 0.3s, opacity 0.3s;
      pointer-events: all;
      cursor: pointer;
      min-width: 180px;
      white-space: nowrap;
      animation: float 3s ease-in-out infinite;
      border: 1px solid rgba(255, 255, 255, 0.18);
      will-change: transform, opacity;
    }

    .popup:hover {
      transform: scale(1.05);
      background: rgba(255, 255, 255, 0.35);
    }

    .popup-content {
      font-size: 18px;
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
      white-space: nowrap;
    }

    .popup-close {
      position: absolute;
      top: 8px;
      right: 12px;
      font-size: 18px;
      color: rgba(255, 255, 255, 0);
      cursor: pointer;
      transition: color 0.2s;
    }

    .popup:hover .popup-close {
      color: rgba(255, 255, 255, 0.7);
    }

    .popup-close:hover {
      color: white;
    }

    .popup-emoji {
      font-size: 24px;
      margin-bottom: 8px;
      filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.2));
    }

    .controls-container {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 1000;
      transition: opacity 0.3s;
    }

    .auto-hide .controls-container {
      opacity: 0;
    }

    .auto-hide .controls-container:hover {
      opacity: 1;
    }

    .settings-btn {
      background: rgba(255, 255, 255, 0.2);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.3);
      color: white;
      width: 50px;
      height: 50px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      cursor: pointer;
      transition: all 0.3s;
    }

    .settings-btn:hover {
      background: rgba(255, 255, 255, 0.3);
      transform: rotate(90deg);
    }

    .controls {
      position: absolute;
      top: 60px;
      right: 0;
      background: rgba(255, 255, 255, 0.25);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border-radius: 16px;
      padding: 20px;
      display: none;
      flex-direction: column;
      gap: 15px;
      width: 300px;
      max-height: 80vh;
      overflow-y: auto;
      border: 1px solid rgba(255, 255, 255, 0.18);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
      transition: opacity 0.5s;
    }

    /* è‡ªå®šä¹‰æ»šåŠ¨æ¡æ ·å¼ */
    .controls::-webkit-scrollbar {
      width: 8px;
    }

    .controls::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 4px;
    }

    .controls::-webkit-scrollbar-thumb {
      background: rgba(255, 255, 255, 0.3);
      border-radius: 4px;
    }

    .controls::-webkit-scrollbar-thumb:hover {
      background: rgba(255, 255, 255, 0.5);
    }

    .controls-container:hover .controls {
      display: flex;
    }

    .controls.show {
      display: flex;
    }

    button {
      background: rgba(255, 255, 255, 0.2);
      border: 1px solid rgba(255, 255, 255, 0.3);
      color: white;
      padding: 12px 20px;
      border-radius: 50px;
      font-size: 16px;
      cursor: pointer;
      transition: all 0.3s;
      backdrop-filter: blur(5px);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }

    button:hover {
      background: rgba(255, 255, 255, 0.3);
      transform: translateY(-2px);
    }

    .counter {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 18px;
      z-index: 10;
      background: rgba(255, 255, 255, 0.2);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      padding: 12px 24px;
      border-radius: 50px;
      border: 1px solid rgba(255, 255, 255, 0.2);
      transition: opacity 0.3s;
    }

    .auto-hide .counter {
      opacity: 0;
    }

    .control-group {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .control-label {
      font-size: 14px;
      opacity: 0.9;
    }

    .control-input {
      background: rgba(255, 255, 255, 0.2);
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 8px;
      padding: 8px 12px;
      color: white;
      font-size: 14px;
    }

    .control-input:focus {
      outline: none;
      border-color: rgba(255, 255, 255, 0.6);
    }

    textarea.control-input {
      min-height: 80px;
      resize: vertical;
    }

    /* è‡ªå®šä¹‰textareaæ»šåŠ¨æ¡ */
    textarea.control-input::-webkit-scrollbar {
      width: 6px;
    }

    textarea.control-input::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 3px;
    }

    textarea.control-input::-webkit-scrollbar-thumb {
      background: rgba(255, 255, 255, 0.3);
      border-radius: 3px;
    }

    textarea.control-input::-webkit-scrollbar-thumb:hover {
      background: rgba(255, 255, 255, 0.5);
    }

    .toggle-container {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .toggle-switch {
      position: relative;
      display: inline-block;
      width: 50px;
      height: 24px;
    }

    .toggle-switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }

    .toggle-slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: rgba(255, 255, 255, 0.3);
      transition: .4s;
      border-radius: 24px;
    }

    .toggle-slider:before {
      position: absolute;
      content: "";
      height: 16px;
      width: 16px;
      left: 4px;
      bottom: 4px;
      background-color: white;
      transition: .4s;
      border-radius: 50%;
    }

    input:checked+.toggle-slider {
      background-color: rgba(106, 17, 203, 0.8);
    }

    input:checked+.toggle-slider:before {
      transform: translateX(26px);
    }

    select.control-input {
      cursor: pointer;
    }

    .category-tabs {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }

    .category-tab {
      background: rgba(255, 255, 255, 0.2);
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 20px;
      padding: 6px 12px;
      font-size: 12px;
      cursor: pointer;
      transition: all 0.3s;
    }

    .category-tab.active {
      background: rgba(255, 255, 255, 0.4);
      border-color: rgba(255, 255, 255, 0.7);
    }

    /* æ–‡æ¡ˆç®¡ç†æ¨¡æ€æ¡†æ ·å¼ */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.7);
      z-index: 2000;
      backdrop-filter: blur(5px);
      -webkit-backdrop-filter: blur(5px);
    }

    .modal-content {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(255, 255, 255, 0.25);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border-radius: 16px;
      padding: 20px;
      width: 90%;
      max-width: 600px;
      max-height: 80vh;
      overflow-y: auto;
      border: 1px solid rgba(255, 255, 255, 0.18);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
    }

    /* æ¨¡æ€æ¡†æ»šåŠ¨æ¡ */
    .modal-content::-webkit-scrollbar {
      width: 8px;
    }

    .modal-content::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 4px;
    }

    .modal-content::-webkit-scrollbar-thumb {
      background: rgba(255, 255, 255, 0.3);
      border-radius: 4px;
    }

    .modal-content::-webkit-scrollbar-thumb:hover {
      background: rgba(255, 255, 255, 0.5);
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      padding-bottom: 10px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.2);
    }

    .modal-title {
      font-size: 1.5rem;
      font-weight: bold;
    }

    .close-modal {
      background: none;
      border: none;
      color: white;
      font-size: 24px;
      cursor: pointer;
      padding: 0;
      width: 30px;
      height: 30px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .message-list {
      display: flex;
      flex-direction: column;
      gap: 10px;
      margin-bottom: 20px;
    }

    .message-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 8px;
    }

    .message-text {
      flex: 1;
    }

    .message-actions {
      display: flex;
      gap: 8px;
    }

    .message-action-btn {
      background: rgba(255, 255, 255, 0.2);
      border: none;
      border-radius: 4px;
      color: white;
      width: 30px;
      height: 30px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s;
    }

    .message-action-btn:hover {
      background: rgba(255, 255, 255, 0.3);
    }

    .add-message-form {
      display: flex;
      gap: 10px;
      margin-top: 20px;
    }

    .add-message-input {
      flex: 1;
      background: rgba(255, 255, 255, 0.2);
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 8px;
      padding: 8px 12px;
      color: white;
    }

    .add-message-input:focus {
      outline: none;
      border-color: rgba(255, 255, 255, 0.6);
    }

    .emoji-selector {
      display: flex;
      gap: 5px;
      margin-top: 10px;
      flex-wrap: wrap;
    }

    .emoji-option {
      background: rgba(255, 255, 255, 0.2);
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 8px;
      padding: 5px 10px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .emoji-option:hover,
    .emoji-option.selected {
      background: rgba(255, 255, 255, 0.4);
    }

    @keyframes float {

      0%,
      100% {
        transform: translateY(0) rotate(0deg);
      }

      50% {
        transform: translateY(-10px) rotate(1deg);
      }
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(20px) scale(0.9);
      }

      to {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }

    .liquid-effect {
      position: fixed;
      width: 200%;
      height: 200%;
      top: -50%;
      left: -50%;
      background: radial-gradient(circle, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0) 70%);
      animation: liquidMove 15s infinite linear;
      z-index: -1;
    }

    @keyframes liquidMove {
      0% {
        transform: rotate(0deg);
      }

      100% {
        transform: rotate(360deg);
      }
    }

    @media (max-width: 768px) {
      button {
        padding: 10px 16px;
        font-size: 14px;
      }

      .controls {
        width: 280px;
      }

      .modal-content {
        width: 95%;
        padding: 15px;
      }
    }
  </style>
</head>

<body>
  <div class="background"></div>
  <div class="background-overlay"></div>
  <div class="liquid-effect"></div>

  <div class="popup-container" id="popupContainer"></div>

  <div class="controls-container">
    <div class="settings-btn">
      <i class="fas fa-cog"></i>
    </div>
    <div class="controls" id="controlsPanel">
      <div class="control-group">
        <div class="control-label">æ–‡æ¡ˆåˆ†ç±»</div>
        <div class="category-tabs">
          <div class="category-tab active" data-category="all">å…¨éƒ¨</div>
          <div class="category-tab" data-category="classic">å¤é£</div>
          <div class="category-tab" data-category="romantic">æµªæ¼«</div>
          <div class="category-tab" data-category="encouraging">å‹‰åŠ±</div>
          <div class="category-tab" data-category="modern">ç°ä»£</div>
        </div>
        <button id="manageMessagesBtn" style="margin-top: 10px;">
          <i class="fas fa-edit"></i> ç®¡ç†æ–‡æ¡ˆ
        </button>
      </div>
      <div class="control-group">
        <div class="control-label">è‡ªå®šä¹‰æ–‡æ¡ˆ</div>
        <textarea id="customMessages" class="control-input" placeholder="è¯·è¾“å…¥è‡ªå®šä¹‰ç¥ç¦è¯­ï¼Œæ¯è¡Œä¸€æ¡"></textarea>
      </div>
      <div class="control-group">
        <div class="control-label">æ€»å¼¹çª—æ•°é‡</div>
        <input type="number" id="popupCount" class="control-input" value="100" min="1" max="1000">
      </div>
      <div class="control-group">
        <div class="control-label">ç”Ÿæˆé€Ÿåº¦ (æ¯«ç§’)</div>
        <input type="number" id="popupSpeed" class="control-input" value="300" min="100" max="2000">
      </div>
      <div class="control-group">
        <div class="control-label">åŒæ—¶æ˜¾ç¤ºæœ€å¤§æ•°é‡</div>
        <input type="number" id="maxVisible" class="control-input" value="100" min="1" max="500">
      </div>
      <button id="toggleBtn">
        <i class="fas fa-play"></i> å¼€å§‹å¼¹çª—
      </button>
      <button id="clearBtn">
        <i class="fas fa-trash"></i> æ¸…é™¤æ‰€æœ‰
      </button>
      <div class="toggle-container">
        <div class="control-label">è‡ªåŠ¨éšè—ç•Œé¢</div>
        <label class="toggle-switch">
          <input type="checkbox" id="autoHideToggle">
          <span class="toggle-slider"></span>
        </label>
      </div>
      <div class="toggle-container">
        <div class="control-label">æ˜¾ç¤ºè®¡æ•°å™¨</div>
        <label class="toggle-switch">
          <input type="checkbox" id="counterToggle" checked>
          <span class="toggle-slider"></span>
        </label>
      </div>
    </div>
  </div>

  <div class="counter" id="counter">
    å·²ç”Ÿæˆ: <span id="count">0</span> / <span id="totalCount">100</span> | å½“å‰æ˜¾ç¤º: <span id="visibleCount">0</span> / <span
      id="maxVisibleCount">100</span>
  </div>

  <!-- æ–‡æ¡ˆç®¡ç†æ¨¡æ€æ¡† -->
  <div class="modal" id="messageModal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title">æ–‡æ¡ˆç®¡ç† - <span id="modalCategoryName">å…¨éƒ¨</span></h2>
        <button class="close-modal">&times;</button>
      </div>
      <div class="message-list" id="messageList">
        <!-- æ–‡æ¡ˆåˆ—è¡¨å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
      </div>
      <div class="add-message-form">
        <input type="text" id="newMessageText" class="add-message-input" placeholder="è¾“å…¥æ–°æ–‡æ¡ˆ">
        <button id="addMessageBtn">æ·»åŠ </button>
      </div>
      <div class="emoji-selector" id="emojiSelector">
        <!-- è¡¨æƒ…é€‰é¡¹å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
      </div>
    </div>
  </div>

  <script>
    let messageLibrary = {
      selfCare: [
        { text: "ä½ å€¼å¾—è¢«çˆ±", emoji: "ğŸ’–" },
        { text: "å…è®¸è‡ªå·±ä¼‘æ¯", emoji: "ğŸ›Œ" },
        { text: "åˆ«è‹›è´£è‡ªå·±", emoji: "ğŸ•Šï¸" },
        { text: "å¥½å¥½åƒé¥­ç¡è§‰", emoji: "ğŸšğŸŒ™" },
        { text: "ä½ å·²è¶³å¤Ÿå¥½", emoji: "ğŸŒŸ" },
        { text: "æ…¢ä¸€ç‚¹ä¹Ÿæ²¡å…³ç³»", emoji: "ğŸŒ" },
        { text: "æƒ…ç»ªéœ€è¦å‡ºå£", emoji: "ğŸ’§" },
        { text: "çˆ±è‡ªå·±ä¼˜å…ˆ", emoji: "ğŸ«¶" },
        { text: "ä¸å¿…äº‹äº‹å®Œç¾", emoji: "âœ¨" },
        { text: "ä»Šå¤©è¾›è‹¦äº†", emoji: "ğŸµ" },
        { text: "ç»™è‡ªå·±ä¸€ä¸ªæ‹¥æŠ±", emoji: "ğŸ¤—" },
        { text: "ä½ çš„æ„Ÿå—é‡è¦", emoji: "â¤ï¸" },
        { text: "åˆ«é€æ”¯è‡ªå·±", emoji: "ğŸ”‹" },
        { text: "é™ä¸‹æ¥å¬å¬å¿ƒ", emoji: "ğŸ§˜" },
        { text: "ä½ æœ¬å°±å®Œæ•´", emoji: "â˜¯ï¸" },
        { text: "åœä¸€åœä¹Ÿå¯ä»¥", emoji: "â¸ï¸" },
        { text: "åˆ«æ€•è¯´ä¸", emoji: "ğŸš«" },
        { text: "ä½ å€¼å¾—è½»æ¾", emoji: "ğŸŒ¤ï¸" },
        { text: "å†…å¿ƒæŸ”è½¯å¾ˆç¾", emoji: "ğŸŒ¸" },
        { text: "æ¥çº³ä¸å®Œç¾çš„ä½ ", emoji: "ğŸŒ±" }
      ],
      gentlePresence: [
        { text: "æˆ‘ä¸€ç›´åœ¨", emoji: "ğŸ•¯ï¸" },
        { text: "ä½ ä¸ç”¨åšå¼º", emoji: "ğŸ›¡ï¸" },
        { text: "æˆ‘æ‡‚ä½ çš„ç´¯", emoji: "ğŸ‘‚" },
        { text: "æ…¢æ…¢è¯´æˆ‘åœ¨å¬", emoji: "ğŸ’¬" },
        { text: "æœ‰æˆ‘åœ¨å‘¢", emoji: "ğŸ¤" },
        { text: "ä½ è¢«çœ‹è§äº†", emoji: "ğŸ‘ï¸" },
        { text: "ä¸å­¤å•æœ‰æˆ‘", emoji: "ğŸ‘«" },
        { text: "æƒ…ç»ªæˆ‘éƒ½æ¥ä½", emoji: "ğŸ«‚" },
        { text: "ä½ å€¼å¾—è¢«æ‡‚", emoji: "ğŸ§ " },
        { text: "æˆ‘é™ªä½ æ²‰é»˜", emoji: "ğŸŒŒ" },
        { text: "åˆ«æ€•è„†å¼±", emoji: "ğŸ¦‹" },
        { text: "ä½ çš„å­˜åœ¨å¾ˆæš–", emoji: "â˜€ï¸" },
        { text: "å›æ¶ˆæ¯å¾ˆå¿«", emoji: "ğŸ“±" },
        { text: "ä½ å¾ˆé‡è¦", emoji: "ğŸ’" },
        { text: "æˆ‘ä¿¡ä½ ", emoji: "ğŸ•Šï¸" },
        { text: "ä½ å€¼å¾—è¢«ç­‰", emoji: "â³" },
        { text: "å®‰å¿ƒåšè‡ªå·±", emoji: "ğŸ¡" },
        { text: "æˆ‘ä¸ºä½ ç•™ç¯", emoji: "ğŸ’¡" },
        { text: "ä½ è¯´è¯æˆ‘çˆ±å¬", emoji: "ğŸ‘‚â¤ï¸" },
        { text: "ä¸–ç•Œåµæˆ‘æŠ¤ä½ ", emoji: "ğŸ›¡ï¸ğŸŒ™" }
      ],
      dailyWarmth: [
        { text: "æ—©é¤è¦åƒçƒ­çš„", emoji: "ğŸ¥£" },
        { text: "ä»Šæ™šæ—©ç‚¹ç¡", emoji: "ğŸ˜´" },
        { text: "é˜³å…‰çœŸå¥½", emoji: "â˜€ï¸" },
        { text: "èŠ±å¼€äº†", emoji: "ğŸŒ¼" },
        { text: "é›¨å£°å¾ˆå®‰å¿ƒ", emoji: "ğŸŒ§ï¸" },
        { text: "è·¯è¾¹æœ‰å°çŒ«", emoji: "ğŸ±" },
        { text: "äº‘å¾ˆæ¸©æŸ”", emoji: "â˜ï¸" },
        { text: "é£å¹è¿‡å‘æ¢¢", emoji: "ğŸƒ" },
        { text: "ä¸€æ¯çƒ­èŒ¶å°±å¥½", emoji: "ğŸµ" },
        { text: "ä»Šå¤©æœ‰ç¬‘å—", emoji: "ğŸ˜Š" },
        { text: "è·¯ç¯ä¸ºä½ äº®ç€", emoji: "ğŸ®" },
        { text: "è¢«çªå¾ˆæš–", emoji: "ğŸ›ï¸" },
        { text: "æ˜å¤©ä¼šæ™´", emoji: "ğŸŒˆ" },
        { text: "å°äº‹ä¹Ÿå€¼å¾—", emoji: "âœ¨" },
        { text: "æ—¥å¸¸å³æµªæ¼«", emoji: "ğŸ“¸" },
        { text: "å¿ƒé™è‡ªç„¶å‡‰", emoji: "ğŸ§˜" },
        { text: "è„šæ­¥å¯ä»¥æ…¢", emoji: "ğŸ‘£" },
        { text: "çƒŸç«æ°”æœ€æŠšäºº", emoji: "ğŸ²" },
        { text: "ä¸€ç¢—é¢çš„å¹¸ç¦", emoji: "ğŸœ" },
        { text: "ä¸–ç•Œå·å·çˆ±ä½ ", emoji: "ğŸŒğŸ’Œ" }
      ],
      innerStrength: [
        { text: "ä½ æ¯”æƒ³è±¡ä¸­å¼º", emoji: "ğŸ’ª" },
        { text: "è·Œå€’äº†å†èµ·", emoji: "ğŸ”„" },
        { text: "å…‰åœ¨ä½ å¿ƒé‡Œ", emoji: "ğŸ’¡" },
        { text: "åšæŒå°±æœ‰å›å“", emoji: "ğŸ””" },
        { text: "ä½ æ­£åœ¨æˆé•¿", emoji: "ğŸŒ±" },
        { text: "é£é›¨ç»ˆä¼šåœ", emoji: "ğŸŒ¤ï¸" },
        { text: "ä½ çš„è·¯ç‹¬ç‰¹", emoji: "ğŸ—ºï¸" },
        { text: "åˆ«ä½ä¼°è‡ªå·±", emoji: "ğŸ‘‘" },
        { text: "é»‘æš—ä¸­æœ‰æ˜Ÿ", emoji: "ğŸŒŒ" },
        { text: "ä¸€æ­¥ä¹Ÿæ˜¯å‰è¿›", emoji: "ğŸš¶" },
        { text: "ä½ æœ‰é€‰æ‹©æƒ", emoji: "âš–ï¸" },
        { text: "æ—¶é—´ä¼šå›ç­”", emoji: "â³" },
        { text: "è½¯å¼±ä¹Ÿæ˜¯å‹‡æ°”", emoji: "ğŸ•Šï¸" },
        { text: "ä½ å€¼å¾—æ›´å¥½", emoji: "ğŸŒˆ" },
        { text: "å¿ƒå®šåˆ™ä¸ä¹±", emoji: "ğŸ§˜" },
        { text: "ä¼¤ç–¤æ˜¯å‹‹ç« ", emoji: "ğŸ–ï¸" },
        { text: "ä½ ç»ˆå°†é—ªè€€", emoji: "âœ¨" },
        { text: "ä½è°·æ˜¯è½¬æœº", emoji: "ğŸ“ˆ" },
        { text: "ä¿¡å¿µä¸ç­", emoji: "ğŸ”¥" },
        { text: "ä½ ç”Ÿæ¥æœ‰å…‰", emoji: "ğŸŒŸ" }
      ],
      authenticConnection: [
        { text: "çœŸè¯šæœ€åŠ¨äºº", emoji: "ğŸ’" },
        { text: "åšçœŸå®çš„ä½ ", emoji: "ğŸ­â¡ï¸ğŸ™‚" },
        { text: "æ— éœ€ä¼ªè£…", emoji: "ğŸª" },
        { text: "ä¿¡ä»»å¾ˆçè´µ", emoji: "ğŸ¤" },
        { text: "å¦è¯šç›¸è§", emoji: "ğŸ‘ï¸ğŸ—¨ï¸" },
        { text: "ä½ æœ¬æ¥å°±å¥½", emoji: "ğŸŒ¼" },
        { text: "ä¸è®¨å¥½ä¹Ÿå¯çˆ±", emoji: "ğŸ¦„" },
        { text: "çœŸå¿ƒæ¢çœŸå¿ƒ", emoji: "â¤ï¸â†”ï¸â¤ï¸" },
        { text: "å…³ç³»è¦èˆ’æœ", emoji: "ğŸ›‹ï¸" },
        { text: "ä½ åœ¨å°±å¥½", emoji: "ğŸ“" },
        { text: "ä¸å¿…è§£é‡Šå¤ªå¤š", emoji: "ğŸ¤«" },
        { text: "æˆ‘å–œæ¬¢ä½ çš„çœŸ", emoji: "ğŸ¥°" },
        { text: "çœŸå®æœ‰åŠ›é‡", emoji: "âš¡" },
        { text: "æƒ…æ„Ÿè¦æµåŠ¨", emoji: "ğŸŒŠ" },
        { text: "å°Šé‡å½¼æ­¤èŠ‚å¥", emoji: "â³ğŸ‘£" },
        { text: "æ‡‚æ¯”çˆ±æ›´éš¾", emoji: "ğŸ§ â¤ï¸" },
        { text: "ä½ åœ¨æˆ‘å°±å®‰å¿ƒ", emoji: "ğŸ§˜â€â™€ï¸" },
        { text: "æ²‰é»˜ä¹Ÿä¸å°´å°¬", emoji: "â˜ï¸" },
        { text: "ä½ å€¼å¾—è¢«çæƒœ", emoji: "ğŸ" },
        { text: "å…³ç³»è´µåœ¨çœŸè¯š", emoji: "ğŸ•Šï¸" }
      ],
      mindfulLiving: [
        { text: "æ­¤åˆ»å³ç¤¼ç‰©", emoji: "ğŸ" },
        { text: "å‘¼å¸æ…¢ä¸€ç‚¹", emoji: "ğŸŒ¬ï¸" },
        { text: "å°‘å³æ˜¯å¤š", emoji: "â–" },
        { text: "å¿ƒå®‰å³æ˜¯å½’å¤„", emoji: "ğŸ " },
        { text: "æ”¾ä¸‹æ‰‹æœºçœ‹çœ‹å¤©", emoji: "ğŸ“±â¡ï¸ğŸŒ¤ï¸" },
        { text: "ä¸“æ³¨å½“ä¸‹", emoji: "ğŸ¯" },
        { text: "ç®€å•å°±å¾ˆç¾", emoji: "ğŸ’®" },
        { text: "åˆ«è®©ç„¦è™‘å·èµ°ä»Šå¤©", emoji: "â³ğŸš«" },
        { text: "æ„Ÿå—æ­¤åˆ»æ¸©åº¦", emoji: "ğŸŒ¡ï¸" },
        { text: "æ…¢é£ŸçŸ¥å‘³", emoji: "ğŸ¥¢" },
        { text: "èµ°è·¯ä¹Ÿä¿®è¡Œ", emoji: "ğŸš¶â€â™‚ï¸" },
        { text: "é™é»˜æœ‰åŠ›é‡", emoji: "ğŸ”‡" },
        { text: "å°‘æ¯”è¾ƒå¤šè‡ªåœ¨", emoji: "ğŸ§˜" },
        { text: "å¿ƒç©ºæ‰èƒ½è£…å…‰", emoji: "ğŸ•³ï¸âœ¨" },
        { text: "ä¸æ€¥ä¸èº", emoji: "ğŸ¢" },
        { text: "æ´»åœ¨å‘¼å¸é—´", emoji: "ğŸŒ¬ï¸â¤ï¸" },
        { text: "ä»Šæ—¥äº‹ä»Šæ—¥æ‚¦", emoji: "ğŸ“…ğŸ˜Š" },
        { text: "ç•™ç™½æ‰æœ‰è¯—æ„", emoji: "ğŸ“œ" },
        { text: "çŸ¥è¶³å¸¸ä¹", emoji: "ğŸ˜Œ" },
        { text: "å¹³å‡¡æ—¥å­é‡Œå‘å…‰", emoji: "âœ¨ğŸ§º" }
      ]
    };
    // æ‰©å±•æ¶ˆæ¯æ•°ç»„åˆ°200ä¸ªä»¥ä¸Š
    let allMessages = [];
    Object.values(messageLibrary).forEach(category => {
      allMessages = allMessages.concat(category);
    });

    // ç¡®ä¿è‡³å°‘æœ‰200æ¡æ¶ˆæ¯
    while (allMessages.length < 200) {
      allMessages = allMessages.concat(allMessages);
    }
    allMessages = allMessages.slice(0, 200);

    // é¢œè‰²æ•°ç»„ - æŸ”å’Œæ¸å˜è‰²
    const colors = [
      "linear-gradient(135deg, rgba(255,154,162,0.8) 0%, rgba(255,183,178,0.8) 100%)",
      "linear-gradient(135deg, rgba(255,218,193,0.8) 0%, rgba(226,240,203,0.8) 100%)",
      "linear-gradient(135deg, rgba(181,234,215,0.8) 0%, rgba(199,206,234,0.8) 100%)",
      "linear-gradient(135deg, rgba(248,177,149,0.8) 0%, rgba(246,114,128,0.8) 100%)",
      "linear-gradient(135deg, rgba(192,108,132,0.8) 0%, rgba(108,91,123,0.8) 100%)",
      "linear-gradient(135deg, rgba(106,17,203,0.8) 0%, rgba(37,117,252,0.8) 100%)",
      "linear-gradient(135deg, rgba(255,107,107,0.8) 0%, rgba(255,181,70,0.8) 100%)",
      "linear-gradient(135deg, rgba(72,198,239,0.8) 0%, rgba(111,134,214,0.8) 100%)",
      "linear-gradient(135deg, rgba(253,203,110,0.8) 0%, rgba(213,153,196,0.8) 100%)",
      "linear-gradient(135deg, rgba(116,235,213,0.8) 0%, rgba(159,172,230,0.8) 100%)"
    ];

    // å¸¸ç”¨è¡¨æƒ…
    const commonEmojis = ["ğŸ˜„", "ğŸ™", "ğŸ’ª", "ğŸŒ™", "ğŸŒˆ", "ğŸš", "ğŸŒ", "ğŸ˜Š", "ğŸ¤¹", "â¤ï¸", "ğŸŒ¸", "ğŸ®", "ğŸ§˜", "ğŸ“±", "ğŸŒŸ", "ğŸŒ¤ï¸", "ğŸŒ…", "ğŸ’«", "â³", "ğŸƒ", "ğŸŒ¿", "âœ¨", "ğŸ‘«", "ğŸ’", "ğŸ¯", "ğŸ’‘", "ğŸ‘", "ğŸŒ²", "ğŸ’˜", "ğŸŒ¹", "ğŸ’", "ğŸŒ„", "â˜€ï¸", "ğŸ’Š", "ğŸ ", "â›°ï¸", "ğŸµ", "ğŸ‚", "âš¡", "ğŸ’¡", "ğŸŒ±", "ğŸ›£ï¸", "â­", "ğŸŒ¬ï¸", "ğŸ›‘", "ğŸ‘‘", "ğŸ”®", "ğŸ", "ğŸ€", "ğŸ“¦", "âœ…", "ğŸ¯", "ğŸ”„", "ğŸ’ƒ", "ğŸ”‹", "ğŸ†", "ğŸ¬", "ğŸ’…", "ğŸ“…"];

    // DOMå…ƒç´ 
    const popupContainer = document.getElementById('popupContainer');
    const toggleBtn = document.getElementById('toggleBtn');
    const clearBtn = document.getElementById('clearBtn');
    const countElement = document.getElementById('count');
    const totalCountElement = document.getElementById('totalCount');
    const visibleCountElement = document.getElementById('visibleCount');
    const maxVisibleCountElement = document.getElementById('maxVisibleCount');
    const popupCountInput = document.getElementById('popupCount');
    const popupSpeedInput = document.getElementById('popupSpeed');
    const maxVisibleInput = document.getElementById('maxVisible');
    const autoHideToggle = document.getElementById('autoHideToggle');
    const counterToggle = document.getElementById('counterToggle');
    const counter = document.getElementById('counter');
    const controlsPanel = document.getElementById('controlsPanel');
    const customMessagesInput = document.getElementById('customMessages');
    const categoryTabs = document.querySelectorAll('.category-tab');
    const manageMessagesBtn = document.getElementById('manageMessagesBtn');
    const messageModal = document.getElementById('messageModal');
    const modalCategoryName = document.getElementById('modalCategoryName');
    const messageList = document.getElementById('messageList');
    const newMessageText = document.getElementById('newMessageText');
    const addMessageBtn = document.getElementById('addMessageBtn');
    const emojiSelector = document.getElementById('emojiSelector');
    const closeModal = document.querySelector('.close-modal');

    // çŠ¶æ€å˜é‡
    let popupInterval;
    let popupCount = 0;
    let visiblePopupCount = 0;
    let isRunning = false;
    let totalPopupCount = 100;
    let popupSpeed = 300;
    let maxVisiblePopups = 100;
    let hideTimeout;
    let currentCategory = 'all';
    let currentMessages = [...allMessages];
    let selectedEmoji = "ğŸ˜Š";
    let managingCategory = 'all';
    let lastFrameTime = 0;
    const frameInterval = 16; // çº¦60fps

    // åˆå§‹åŒ–
    function init () {
      updateTotalCountDisplay();
      updateVisibleCount();
      toggleCounter();
      setupEventListeners();
      populateEmojiSelector();

      // åˆå§‹åˆ›å»ºå‡ ä¸ªå¼¹çª—
      for (let i = 0; i < 5; i++) {
        setTimeout(() => {
          createPopup();
        }, i * 300);
      }
    }

    // è®¾ç½®äº‹ä»¶ç›‘å¬å™¨
    function setupEventListeners () {
      // ä½¿ç”¨äº‹ä»¶å§”æ‰˜å¤„ç†å¼¹çª—ç‚¹å‡»
      popupContainer.addEventListener('click', function (e) {
        const popup = e.target.closest('.popup');
        if (!popup) return;

        if (e.target.classList.contains('popup-close')) {
          popup.remove();
          visiblePopupCount--;
          updateVisibleCount();
        } else {
          // ç‚¹å‡»å¼¹çª—å†…å®¹æ—¶æ”¾å¤§æ˜¾ç¤º
          popup.style.transform = 'scale(1.2)';
          popup.style.zIndex = '1000';
          setTimeout(() => {
            popup.style.transform = 'scale(1)';
            popup.style.zIndex = '100';
          }, 500);
        }
      });

      // æ§åˆ¶æŒ‰é’®äº‹ä»¶
      toggleBtn.addEventListener('click', function () {
        if (isRunning) {
          pausePopups();
        } else {
          startPopups();
        }
      });

      clearBtn.addEventListener('click', clearPopups);
      autoHideToggle.addEventListener('change', toggleAutoHide);
      counterToggle.addEventListener('change', toggleCounter);

      // åˆ†ç±»æ ‡ç­¾ç‚¹å‡»äº‹ä»¶
      categoryTabs.forEach(tab => {
        tab.addEventListener('click', function () {
          switchCategory(this.dataset.category);
        });
      });

      // è‡ªå®šä¹‰æ¶ˆæ¯å˜åŒ–æ—¶æ›´æ–°å½“å‰æ¶ˆæ¯åˆ—è¡¨
      customMessagesInput.addEventListener('input', function () {
        if (isRunning) {
          updateCurrentMessages();
        }
      });

      // è®¾ç½®é¢æ¿æ˜¾ç¤ºå»¶è¿Ÿ
      const controlsContainer = document.querySelector('.controls-container');
      controlsContainer.addEventListener('mouseenter', function () {
        clearTimeout(hideTimeout);
        controlsPanel.style.display = 'flex';
      });

      controlsContainer.addEventListener('mouseleave', function () {
        hideTimeout = setTimeout(function () {
          controlsPanel.style.display = 'none';
        }, 500);
      });

      // æ–‡æ¡ˆç®¡ç†ç›¸å…³äº‹ä»¶
      manageMessagesBtn.addEventListener('click', openMessageModal);
      closeModal.addEventListener('click', closeMessageModal);
      addMessageBtn.addEventListener('click', addNewMessage);

      // ç‚¹å‡»æ¨¡æ€æ¡†å¤–éƒ¨å…³é—­
      window.addEventListener('click', function (e) {
        if (e.target === messageModal) {
          closeMessageModal();
        }
      });
    }

    // å¡«å……è¡¨æƒ…é€‰æ‹©å™¨
    function populateEmojiSelector () {
      emojiSelector.innerHTML = '';
      commonEmojis.forEach(emoji => {
        const emojiOption = document.createElement('div');
        emojiOption.className = 'emoji-option';
        emojiOption.textContent = emoji;
        emojiOption.addEventListener('click', function () {
          // ç§»é™¤ä¹‹å‰é€‰ä¸­çš„è¡¨æƒ…
          document.querySelectorAll('.emoji-option').forEach(opt => {
            opt.classList.remove('selected');
          });
          // é€‰ä¸­å½“å‰è¡¨æƒ…
          this.classList.add('selected');
          selectedEmoji = emoji;
        });
        emojiSelector.appendChild(emojiOption);
      });

      // é»˜è®¤é€‰ä¸­ç¬¬ä¸€ä¸ªè¡¨æƒ…
      if (emojiSelector.firstChild) {
        emojiSelector.firstChild.classList.add('selected');
      }
    }

    // æ‰“å¼€æ–‡æ¡ˆç®¡ç†æ¨¡æ€æ¡†
    function openMessageModal () {
      managingCategory = currentCategory;
      modalCategoryName.textContent = getCategoryName(managingCategory);
      renderMessageList();
      messageModal.style.display = 'block';
    }

    // å…³é—­æ–‡æ¡ˆç®¡ç†æ¨¡æ€æ¡†
    function closeMessageModal () {
      messageModal.style.display = 'none';
    }

    // è·å–åˆ†ç±»åç§°
    function getCategoryName (category) {
      const names = {
        'all': 'å…¨éƒ¨',
        'classic': 'å¤é£',
        'romantic': 'æµªæ¼«',
        'encouraging': 'å‹‰åŠ±',
        'modern': 'ç°ä»£'
      };
      return names[category] || category;
    }

    // æ¸²æŸ“æ–‡æ¡ˆåˆ—è¡¨
    function renderMessageList () {
      messageList.innerHTML = '';
      let messages = [];

      if (managingCategory === 'all') {
        // æ˜¾ç¤ºæ‰€æœ‰åˆ†ç±»çš„æ–‡æ¡ˆ
        Object.values(messageLibrary).forEach(categoryMessages => {
          messages = messages.concat(categoryMessages);
        });
      } else {
        messages = [...messageLibrary[managingCategory]];
      }

      messages.forEach((message, index) => {
        const messageItem = document.createElement('div');
        messageItem.className = 'message-item';
        messageItem.innerHTML = `
                    <div class="message-text">${message.emoji} ${message.text}</div>
                    <div class="message-actions">
                        <button class="message-action-btn edit-message" data-index="${index}">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="message-action-btn delete-message" data-index="${index}">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `;
        messageList.appendChild(messageItem);
      });

      // æ·»åŠ ç¼–è¾‘å’Œåˆ é™¤äº‹ä»¶
      document.querySelectorAll('.edit-message').forEach(btn => {
        btn.addEventListener('click', function () {
          const index = parseInt(this.dataset.index);
          editMessage(index);
        });
      });

      document.querySelectorAll('.delete-message').forEach(btn => {
        btn.addEventListener('click', function () {
          const index = parseInt(this.dataset.index);
          deleteMessage(index);
        });
      });
    }

    // ç¼–è¾‘æ–‡æ¡ˆ
    function editMessage (index) {
      let messages = [];

      if (managingCategory === 'all') {
        // è·å–æ‰€æœ‰åˆ†ç±»çš„æ–‡æ¡ˆ
        Object.values(messageLibrary).forEach(categoryMessages => {
          messages = messages.concat(categoryMessages);
        });
      } else {
        messages = messageLibrary[managingCategory];
      }

      const message = messages[index];
      const newText = prompt('ç¼–è¾‘æ–‡æ¡ˆ:', message.text);
      if (newText !== null && newText.trim() !== '') {
        message.text = newText.trim();
        renderMessageList();
        updateCurrentMessages();
      }
    }

    // åˆ é™¤æ–‡æ¡ˆ
    function deleteMessage (index) {
      if (confirm('ç¡®å®šè¦åˆ é™¤è¿™æ¡æ–‡æ¡ˆå—ï¼Ÿ')) {
        if (managingCategory === 'all') {
          // ä»æ‰€æœ‰åˆ†ç±»ä¸­åˆ é™¤è¿™æ¡æ–‡æ¡ˆ
          Object.keys(messageLibrary).forEach(category => {
            const categoryIndex = messageLibrary[category].findIndex(msg =>
              msg.text === messages[index].text && msg.emoji === messages[index].emoji
            );
            if (categoryIndex !== -1) {
              messageLibrary[category].splice(categoryIndex, 1);
            }
          });
        } else {
          messageLibrary[managingCategory].splice(index, 1);
        }

        renderMessageList();
        updateCurrentMessages();
      }
    }

    // æ·»åŠ æ–°æ–‡æ¡ˆ
    function addNewMessage () {
      const text = newMessageText.value.trim();
      if (text === '') {
        alert('è¯·è¾“å…¥æ–‡æ¡ˆå†…å®¹');
        return;
      }

      const newMessage = {
        text: text,
        emoji: selectedEmoji
      };

      if (managingCategory === 'all') {
        // æ·»åŠ åˆ°é»˜è®¤åˆ†ç±»
        if (!messageLibrary.default) {
          messageLibrary.default = [];
        }
        messageLibrary.default.push(newMessage);
      } else {
        messageLibrary[managingCategory].push(newMessage);
      }

      newMessageText.value = '';
      renderMessageList();
      updateCurrentMessages();
    }

    // æ›´æ–°æ€»å¼¹çª—æ•°æ˜¾ç¤º
    function updateTotalCountDisplay () {
      totalCountElement.textContent = totalPopupCount;
      maxVisibleCountElement.textContent = maxVisiblePopups;
    }

    // åˆ‡æ¢åˆ†ç±»
    function switchCategory (category) {
      currentCategory = category;

      // æ›´æ–°æ ‡ç­¾çŠ¶æ€
      categoryTabs.forEach(tab => {
        if (tab.dataset.category === category) {
          tab.classList.add('active');
        } else {
          tab.classList.remove('active');
        }
      });

      updateCurrentMessages();
    }

    // æ›´æ–°å½“å‰æ¶ˆæ¯åˆ—è¡¨
    function updateCurrentMessages () {
      if (currentCategory === 'all') {
        currentMessages = [];
        Object.values(messageLibrary).forEach(category => {
          currentMessages = currentMessages.concat(category);
        });
      } else {
        currentMessages = [...messageLibrary[currentCategory]];
      }

      // æ·»åŠ è‡ªå®šä¹‰æ¶ˆæ¯
      const customMessages = getCustomMessages();
      if (customMessages.length > 0) {
        currentMessages = currentMessages.concat(customMessages);
      }
    }

    // è·å–è‡ªå®šä¹‰æ¶ˆæ¯
    function getCustomMessages () {
      const customText = customMessagesInput.value.trim();
      if (!customText) return [];

      return customText.split('\n')
        .filter(line => line.trim().length > 0)
        .map(line => {
          return {
            text: line.trim(),
            emoji: "ğŸ’«" // é»˜è®¤è¡¨æƒ…
          };
        });
    }

    // åˆ›å»ºå¼¹çª—
    function createPopup () {
      if (popupCount >= totalPopupCount) {
        pausePopups();
        return;
      }

      // æ£€æŸ¥å½“å‰å¯è§å¼¹çª—æ•°é‡
      if (visiblePopupCount >= maxVisiblePopups) {
        // å¦‚æœè¶…è¿‡æœ€å¤§å¯è§æ•°é‡ï¼Œç§»é™¤æœ€æ—©çš„ä¸€ä¸ªå¼¹çª—
        const oldestPopup = popupContainer.firstChild;
        if (oldestPopup) {
          oldestPopup.remove();
          visiblePopupCount--;
          updateVisibleCount();
        }
      }

      const popup = document.createElement('div');
      popup.className = 'popup';

      // éšæœºä½ç½®
      const left = Math.floor(Math.random() * (window.innerWidth - 200));
      const top = Math.floor(Math.random() * (window.innerHeight - 100));

      // éšæœºæ ·å¼
      const messageIndex = Math.floor(Math.random() * currentMessages.length);
      const message = currentMessages[messageIndex];
      const color = colors[Math.floor(Math.random() * colors.length)];

      popup.style.cssText = `
                left: ${left}px;
                top: ${top}px;
                background: ${color};
                animation: fadeIn 0.5s ease-out;
            `;

      // æ·»åŠ å†…å®¹
      popup.innerHTML = `
                <div class="popup-emoji">${message.emoji}</div>
                <div class="popup-content">${message.text}</div>
                <div class="popup-close">Ã—</div>
            `;

      popupContainer.appendChild(popup);
      visiblePopupCount++;
      updateCount(1);
      updateVisibleCount();
    }

    // æ›´æ–°æ€»ç”Ÿæˆè®¡æ•°å™¨
    function updateCount (change) {
      popupCount += change;
      countElement.textContent = popupCount;
    }

    // æ›´æ–°å¯è§å¼¹çª—è®¡æ•°å™¨
    function updateVisibleCount () {
      visibleCountElement.textContent = visiblePopupCount;
    }

    // å¼€å§‹å¼¹çª—
    function startPopups () {
      if (isRunning) return;

      // è·å–è®¾ç½®å€¼
      totalPopupCount = parseInt(popupCountInput.value) || 100;
      popupSpeed = parseInt(popupSpeedInput.value) || 300;
      maxVisiblePopups = parseInt(maxVisibleInput.value) || 100;

      // æ›´æ–°å½“å‰æ¶ˆæ¯åˆ—è¡¨ï¼ˆåŒ…å«è‡ªå®šä¹‰æ¶ˆæ¯ï¼‰
      updateCurrentMessages();

      // æ›´æ–°æ˜¾ç¤º
      updateTotalCountDisplay();

      isRunning = true;
      popupInterval = setInterval(() => {
        const now = performance.now();
        if (now - lastFrameTime >= frameInterval) {
          createPopup();
          lastFrameTime = now;
        }
      }, popupSpeed);
      toggleBtn.innerHTML = '<i class="fas fa-pause"></i> æš‚åœç”Ÿæˆ';
    }

    // æš‚åœå¼¹çª—
    function pausePopups () {
      clearInterval(popupInterval);
      isRunning = false;
      toggleBtn.innerHTML = '<i class="fas fa-play"></i> ç»§ç»­ç”Ÿæˆ';
    }

    // æ¸…é™¤æ‰€æœ‰å¼¹çª—
    function clearPopups () {
      popupContainer.innerHTML = '';
      popupCount = 0;
      visiblePopupCount = 0;
      countElement.textContent = '0';
      updateVisibleCount();
    }

    // è‡ªåŠ¨éšè—æ§åˆ¶
    function toggleAutoHide () {
      if (autoHideToggle.checked) {
        document.body.classList.add('auto-hide');
      } else {
        document.body.classList.remove('auto-hide');
      }
    }

    // è®¡æ•°å™¨æ˜¾ç¤ºæ§åˆ¶
    function toggleCounter () {
      if (counterToggle.checked) {
        counter.style.display = 'block';
      } else {
        counter.style.display = 'none';
      }
    }

    // åˆå§‹åŒ–åº”ç”¨
    init();
  </script>
</body>

</html>